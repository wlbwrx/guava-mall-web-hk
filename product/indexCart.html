<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=no, viewport-fit=cover"/>
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
	
	<meta property="og:type"          content="website" />
	<meta property="og:title"         content="【阿噗購物】訂單確認-購物，從阿噗開始" />
	<meta property="og:description"   content="阿噗特賣，您的穿搭生活頻道。主營：女裝、男裝、鞋包配飾、美妝護膚、家居生活。滿HK$200享8折價 / 支持貨到付款 / 官方自營 / 100%正品保障 / 7天無憂退換貨。" />
	<meta property="og:image"         content="https://d3o2c7bn83e5x8.cloudfront.net/image/shareIcon.jpg" />
	<title>阿噗購物</title>
	<meta name="description" content="阿噗特賣，您的穿搭生活頻道。主營：女裝、男裝、鞋包配飾、美妝護膚、家居生活。滿HK$200享8折價 / 支持貨到付款 / 官方自營 / 100%正品保障 / 7天無憂退換貨。!">
	
	<!-- 安卓平台 chrome -->
	<meta name="mobile-web-app-capable" content="yes">
	<link rel="icon" sizes="192x192" href="https://d3o2c7bn83e5x8.cloudfront.net/image/shareIcon-mini.jpg">
	<!-- ios平台 safari -->
	<!-- <meta name="apple-mobile-web-app-capable" content="yes"> -->
	<!-- <meta name="apple-mobile-web-app-status-bar-style" content="black"> -->
	<link rel="apple-touch-icon-precomposed" href="https://d3o2c7bn83e5x8.cloudfront.net/image/shareIcon.jpg">
	
	<!-- <meta http-equiv="Content-Security-Policy" content="upgrade-insecure-requests"> -->

	<meta name="renderer" content="webkit">
	<!-- <meta name="nav"> -->
	<meta http-equiv="Expires" CONTENT="0">
	<meta http-equiv="Cache-Control" CONTENT="no-cache">
	<meta http-equiv="Pragma" CONTENT="no-cache">
    <link rel="shortcut icon" href="https://d3o2c7bn83e5x8.cloudfront.net/image/favicon.ico" type="image/x-icon" />
    <link rel="stylesheet" href="https://d3o2c7bn83e5x8.cloudfront.net/dist/Swiper/css/swiper.css">
    <link rel="stylesheet" href="https://d3o2c7bn83e5x8.cloudfront.net/dist/mdui/css/mdui.min.css">
    <link rel="stylesheet" href="https://d3o2c7bn83e5x8.cloudfront.net/dist/city-picker/css/city-picker.css">
    <link rel="stylesheet" href="../css/common.css?v=20210125">
	<style>
		/* .mdui-appbar .top-left-options.noNav > .left{display: none;}
		.mdui-appbar .top-left-options.noNav > .text-icon-options{margin-left: 0;}
		.mdui-appbar .top-left-options:not(.noNav) > .text-icon-options{display: none;}
		.mdui-appbar .top-left-options:not(.noNav) + div + div .text-icon-options{display: none;} */

		.city-picker-dropdown{min-width: auto;max-width: 79vw;}
		.city-picker-span{height: 42px;line-height: 42px;}
		.city-picker-span > .placeholder{color: #D1D1D1}

        .mdui-address{position:relative;box-sizing:border-box;min-height:75px;background:#FFFCEC url(https://d3o2c7bn83e5x8.cloudfront.net/image/border.jpg) bottom repeat-x;font-size:14px;color:#363636;padding:12px 4%;cursor:pointer}
		.mdui-address span{display:inline-block;margin-right:12px;line-height:24px;font-weight:700;font-size: 16px}
		.mdui-address span:last-child{display:block;font-weight:500;font-size: 12px}
		.mdui-address .mdui-icon{position:absolute;top:23px;right:4%;font-size:24px;margin-right:-10px;color:#979797!important}
		body .mdui-appbar-fixed{
			z-index:2;
		}
		.mdui-cart-products{background:#FFF;}
		/* .mdui-cart-products .mdui-list-item{padding: 0;margin-top: 15px}
		.mdui-cart-products .mdui-list-item:hover{background-color:initial}
		.mdui-cart-products .mdui-list-item .check-icon{width:20px;height:20px;margin-right:10px}
		.mdui-cart-products .mdui-list-item .exchange-check{width:20px;height:20px;margin-right:10px}
		.mdui-cart-products .mdui-list-item .mdui-list-item-title{font-size:14px;color:#000;line-height:14px;height:16px;margin-bottom:8px}
		.mdui-cart-products .mdui-list-item .mdui-list-item-text{font-size:12px;color:#7B7B7B;height: auto;} */
		.mdui-cart-products .mdui-cart-product-sku-img{width:80px;height:80px;margin-right:10px;vertical-align:middle}
		.mdui-cart-products .mdui-cart-product-sku-info{padding-top:2px;flex-grow:1;height:78px;position:relative;top:0;float:right}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2{position:absolute;width:100%;bottom:2px}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2 .mdui-list-item-text-price{font-size:14px;color:#B4272D}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2 .mdui-list-item-text-price .original-price{font-size:12px;color:#777;text-decoration:line-through}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2 .delete-icon{width:18px;height:18px;position:relative;top:4px;margin:0 10px}

		.mdui-cart-products .mdui-list{padding:0}
		.mdui-cart-products .mdui-list>.mdui-divider-inset{margin:0!important;background-color:rgba(0,0,0,.1)}

		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags{display: inline-block;border-radius: 8px;height: 16px;padding: 3px 4px;box-sizing: border-box;background: rgba(180, 39, 45, .1);color: #B4272D;margin-right: 3px;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags span{font-size: 12px;display: block;text-align: center;transform: scale(0.8);line-height: 10px;}
		.mdui-cart-products .mdui-list-item-title .mdui-list-item-promotion-tags-depletion{display: inline-block;border-radius: 8px;height: 16px;padding: 3px 4px;box-sizing: border-box;background: rgba(242, 143, 45, .1);color: #F56207;margin-right: 3px;}
		.mdui-cart-products .mdui-list-item-title .mdui-list-item-promotion-tags-depletion span{font-size: 12px;display: block;text-align: center;transform: scale(0.8);line-height: 10px;}
		
		.mdui-cart-products .mdui-list-item-remark{display: block;width: 100%;color: #BCBCBC;line-height: 10px;margin-top: 8px}
		.mdui-cart-products .mdui-list-item-remark span{margin-left: -16px;font-size: 12px;display: inline-block;transform: scale(0.8);}

		/* .mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags{display: flex;margin-top: 2px;width: 156px; border-radius: 12px;overflow: hidden;font-size: 0;border: 1px solid #979797}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags span{font-size: 12px;display: block;text-align: center;line-height: 16px}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags span:first-child{background: #979797;color: #FFF;width: 36px;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags span:last-child{color: #979797;background: #fff;flex: 1}

		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags-1{border: 1px solid #F28F2D;width: 52px;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags-1 span:first-child{width: 52px;background:#fff;color: #F28F2D} */

		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2.promotion-text{bottom:4px}
		.mdui-cart-products .mdui-cart-product-sku-info .promotion-num{font-size:12px;color:#7B7B7B}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2.promotion-text .mdui-list-item-text-price{top:0}

		.mdui-cart-products .mdui-cart-products-bottom{padding:0 4%;padding-left:calc(4% + 35px);height:40px;line-height:40px;border-top:1px solid #EDEDED;cursor:pointer}
		.mdui-cart-products .mdui-cart-products-bottom .promotion-price{color:#B4272D}
		.mdui-cart-products .mdui-cart-products-bottom .mdui-float-right{color:#B4272D}
		.mdui-cart-products .mdui-cart-products-bottom .mdui-float-right .mdui-icon{color:#B4272D;margin-top:-2px;margin-right:-10px}

		body.mdui-bottom-nav-fixed .mdui-bottom-nav{height: auto;display: block;background:#ffffff;}
		.mdui-bottom-nav{padding:0;position:relative;box-sizing:border-box;z-index:1;border-top:1px solid #EDEDED;}
        .mdui-bottom-nav .mdui-color-white{height: auto;padding-bottom:calc(0px + env(safe-area-inset-bottom));}

		.mdui-bottom-nav .info{color:#B4272D;font-size:26px;padding-left: 16px;width: 200px;}
		.mdui-bottom-nav .info span:first-child{font-size:14px;font-weight:400;color:#B4272D;}
		.mdui-bottom-nav .info span:last-child{font-size:12px;font-weight:400;color: #B4272D;}
		.mdui-bottom-nav #buyNow{height:50px;width:120px;float: right;border-radius:0}
		.mdui-bottom-nav #buyNow span{display: block;font-size: 16px; height: 16px;line-height: 16px;}
		.mdui-bottom-nav #buyNow span:first-child{font-size: 12px; height: auto; line-height: 12px;padding-bottom: 3px; }
		.mdui-bottom-nav #buyNow.no-active{background-color:#EF9A9A!important}

		.open-comments{color: #B4272D;font-size:14px;margin: 18px 0;display: block;padding: 0 4%}
		.done-comments button{border: none;background: transparent;color: #B4272D;padding: 0;font-size: 14px}

		.mdui-cart-comments{margin-top:10px;margin-bottom:10px;padding:15px 4% 12px 4%;background:#FFF;font-size: #000;display: none}
		.mdui-cart-comments > span{display: flex;justify-content: space-between;align-items: center;padding-bottom: 8px;font-size: #000;font-size: 14px}
		.mdui-cart-comments > span img{width: 18px;}
		.mdui-cart-comments.noWrite > span img{opacity: 0.3}
		.mdui-cart-comments .mdui-cart-comments-area{width:100%;height:80px;resize:none;border:none;border-radius:2px;box-sizing:border-box;outline:0;font-size:12px}
		.mdui-cart-comments .comments-bottom{text-align: right;}
		.mdui-cart-comments .comments-bottom button{border: none;background: transparent;padding: 7px 11px}
		.mdui-cart-comments .comments-bottom button:focus{outline: none}
		.mdui-cart-comments .comments-bottom .cancel{color: #777777}
		.mdui-cart-comments .comments-bottom .submit{color: #fff;background: #B4272D;border-radius: 4px}
		.mdui-cart-comments.noWrite .comments-bottom .submit{opacity: 0.3}

		.click-add-address{text-align:center;margin-top:10px}
		.click-add-address>.mdui-btn{color:#B4272D;font-size:16px;height:28px;line-height:28px;background:0 0;font-weight: 700}

    	/*適配iphone5*/
		@media (max-width:320px){
			.mdui-cart-products .mdui-cart-product-sku-img{width:90px;height:90px}
			.mdui-cart-products .mdui-cart-product-sku-info{width:calc(100% - 135px);height:90px}
		}

		.mdui-pay-info{margin-top:10px}
		.mdui-pay-info .mdui-list{padding:10px 4%}
		.mdui-pay-info .mdui-list .mdui-list-item{box-sizing: border-box;align-items: flex-start;padding: 9px 0;font-size: 14px;min-height: 24px;line-height: 12px;color:#000;display:flex;justify-content:space-between}
		.mdui-pay-info .mdui-list .mdui-list-item:hover{background:#fff}
		.mdui-pay-info .mdui-list .mdui-list-item:after{height: auto;}
		.mdui-pay-info .mdui-list .mdui-list-item:last-child{border-bottom:0}
		.mdui-pay-info .mdui-list .mdui-list-item span{flex-grow:1}
		.mdui-pay-info .mdui-list .mdui-list-item > div{font-size: 14px}

		.openSelect{background: #fff;color:#000;padding: 6px 4% 5px;}
		.openSelect > div{display: flex;align-items: center;justify-content: space-between;padding: 10px 0;border-top: 1px dashed #EDEDED;width: 100%;color: #000;}
		.openSelect:first-child > div{border-top: 0}
		.openSelect .typeMes{display: flex;align-items: center;flex: 1;justify-content: flex-end;}
		.openSelect .typeMes div{color: #777;}

		.selectMarketView .view-bottom-content{height: 100%;padding: 0}
		.selectMarketView .view-bottom-content .step1{margin: 0 4%;}
		.selectMarketView .view-bottom-content .step1 ul{padding: 0;margin-top: 20px;display: flex;justify-content: center;align-items: center;list-style: none}
		.selectMarketView .view-bottom-content .step1 ul li{border:1px solid #BCBCBC;width: 50%;border-radius:8px;padding: 8px;display: flex;justify-content: space-between;align-items: center;}
		.selectMarketView .view-bottom-content .step1 ul li:nth-child(2n){margin-left: 5px}
		.selectMarketView .view-bottom-content .step1 ul li:nth-child(2n+1){margin-right: 5px}
		.selectMarketView .view-bottom-content .step1 ul li i{margin-right: -8px;}
		.selectMarketView .view-bottom-content .step2{display: none;height: 100%;}
		.selectMarketView .view-bottom-content .step2 .breadNav{border-bottom: 1px solid #EDEDED;height: 44px;padding: 0 4%;display: flex;align-items: center}
		.selectMarketView .view-bottom-content .step2 .breadNav .noVal{color: #BCBCBC!important}
		.selectMarketView .view-bottom-content .step2 .breadNav .level_type{display: flex;align-items: center}
		.selectMarketView .view-bottom-content .step2 .breadNav img{width: 24px;margin-right: 6px}
		.selectMarketView .view-bottom-content .step2 .selectAdd{height: calc(100% - 45px);overflow-y: auto;position: relative;width: 100vw;overflow-x: hidden}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul{background: #fff;margin: 0 4% 60px ;list-style: none;padding: 0;position: absolute;width: 92%;box-sizing: border-box}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul.level_town,
		.selectMarketView .view-bottom-content .step2 .selectAdd ul.level_market{left: 100vw;}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul li{line-height:40px;color: #000;}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul li.active{color: #B4272D;}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul.level_market li{line-height: 14px;padding-top: 20px;}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul.level_market li i{display: block;font-style: normal;font-size: 12px;color: #777777;line-height: 12px;padding-top: 8px;}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul.show{display: block!important}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul:not(.show){display: none!important}
		@keyframes showNext{from {left: 100vw;}to {left: 0;}}
		@keyframes showPrev{from {left: 0;}to {left: 100vw;}}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul.showNext{left: 0;animation: 0s showNext ease-in-out;display: block}
		.selectMarketView .view-bottom-content .step2 .selectAdd ul.showPrev{left: 100vw;animation: 0s showPrev ease-in-out;display: block}

		.selectSuperMarket{display: block}
		.selectSuperMarket > div:first-child{display: flex;justify-content: space-between;align-items: center;min-height: 48px;}
		.selectSuperMarket .typeMes{display: flex;justify-content: space-between;align-items: center;}
		.selectSuperMarket .typeMes > div{color: #BCBCBC;justify-content: flex-end;align-items: center;display: flex;}
		.selectSuperMarket .marketDetail{padding-right: 10px;padding-right: 15px;text-align: right;font-size: 12px;}

		.inputCouponView .useCoupon{margin-top: 25px;padding: 0 4%;}
		.inputCouponView .useCoupon > div{display: flex;align-items: center}
		.inputCouponView .useCoupon > span{font-size: 12px;padding: 8px 0;display: block;}
		.inputCouponView .useCoupon input{font-size: 14px;flex: 1;border: 1px solid #BCBCBC;border-radius: 4px;height: 44px;padding: 0 12px;box-sizing: border-box}
		.inputCouponView .useCoupon *:focus{outline: none;}
		.inputCouponView .useCoupon button{font-size: 14px;margin-left: 12px;border: 0;opacity: 1;color: #FFFFFF;height: 38px;padding: 12px 18px;text-align: center;line-height: 12px;background: #9F8A60;border-radius: 4px;}
		/* .inputCouponView .useCoupon button.noUse{opacity: 0.5} */
	
		.addressView .view-bottom-head{position: relative}
		.addressView .view-bottom-head button{position: relative;z-index: 1}
		.addressView .view-bottom-head span{position: absolute;text-align: center;left: 0;right: 0;z-index: 0}
		.addressView .view-bottom-head .success{border: 1px solid #B4272D;background: #fff;color: #B4272D;font-size: 12px;height: 26px}
		.addressView .saveAddress{margin-top: 10px;height: 40px;border: none;width: 100%;background: #B4272D;border-radius: 4px;font-size: 16px;color: #FFFFFF;text-align: center;line-height: 16px;}
		.addressView .mdui-list .mdui-list-item{padding:0;color:#363636}
		.addressView .mdui-list .mdui-list-item label{font-size: 14px}
		.addressView .mdui-list .mdui-list-tip{padding: 0 15px 6px;font-size: 11px;color: #F28F2D;margin: 0 -4%;}
		.addressView .mdui-list .mdui-list-item:hover{background-color:initial}
		.addressView .address-home .mdui-list .mdui-list-item label{width:60px;min-width:60px}
		.addressView .address-market .mdui-list .mdui-list-item label{width:100px;min-width:100px}
		.addressView .mdui-list .mdui-list-item input{text-align: right;flex: 1;outline:0;background:#FFF;height:40px;border:none;font-size:14px;font-family:PingFangSC-Light,helvetica,'Heiti SC',"Hiragino Sans GB","Microsoft Yahei",sans-serif}
		.addressView .address-home .mdui-list .mdui-list-item input{text-align: left}
		.mdui-list-address{font-size: 14px}

		input::-webkit-input-placeholder{color:#D1D1D1}
		input::-moz-placeholder{color:#D1D1D1}
		input:-moz-placeholder{color:#D1D1D1}
		input:-ms-input-placeholder{color:#D1D1D1}

		.addressView .mdui-list-address .mdui-select{font-size: 12px;color: #363636;width:100px;}
		
		#card-errors{margin-top: 10px;color: #B4272D;}
		
		/* 选择付款方式-当前页 */
		/* .openPayType ul{padding: 0;list-style: none;margin: 0}
		.openPayType ul li{cursor: pointer;padding: 10px 0;display: flex;align-items: center;font-size: 14px;color: #000;}
		.openPayType ul li.tip-stripe{padding: 0 0 10px 30px;font-size: 12px;color: #777;margin-top: -5px}
		.openPayType ul li .typeCon{display: flex;justify-content: flex-start;font-size: 14px;width: 100%;}
		.openPayType ul li .typeCon p{margin: 0 10px 0 0;display: inline;line-height: 20px;text-wrap:none;}
		.openPayType ul li .check-icon{height: 20px;margin-right: 10px}
		.openPayType ul li img:not(.check-icon){height: 16px;margin-right: 6px} */
		/* 选择付款方式-弹框 */
		.selectPayType .view-bottom-box .view-bottom-footer{padding: 0 4%}
		.selectPayType .view-bottom-box .view-bottom-footer .successToNext{height: 38px;margin-top: -3px}
		.selectPayType .view-bottom-box .successToNext:focus{outline: none}
		.selectPayType .view-bottom-box .view-bottom-content ul{padding: 0;list-style: none;margin: 0}
		.selectPayType .view-bottom-box .view-bottom-content ul li{cursor: pointer;padding: 14px 0;display: flex;align-items: center;font-size: 14px;color: #000;}
		.selectPayType .view-bottom-box .view-bottom-content ul li.tips{font-size:12px;color:#777;line-height:12px;padding: 0;margin-top: -7px;padding-left: 30px;padding-bottom: 14px}
		.selectPayType .view-bottom-box .view-bottom-content ul li .typeCon{display: flex;justify-content: center;font-size: 14px;}
		.selectPayType .view-bottom-box .view-bottom-content ul li .typeCon span{margin: 0 10px 0 0;display: inline;line-height: 20px;word-break: keep-all;}
		.selectPayType .view-bottom-box .view-bottom-content ul li .check-icon{height: 20px;margin-right: 10px}
		.selectPayType .view-bottom-box .view-bottom-content ul li img:not(.check-icon){height: 16px;margin-right: 6px}

		.mdui-dialog.mdui-noemail-dialog{z-index: 10000;}
		.mdui-dialog.mdui-noemail-dialog .mdui-dialog-actions{padding:0}
		.mdui-dialog.mdui-noemail-dialog .mdui-dialog-actions .mdui-btn{background:#B4272D;color:#FFF;text-align:center}
		.mdui-dialog.mdui-noemail-dialog > .mdui-dialog-title{font-size:14px;color:#363636;padding:20px 15px 10px 15px;font-weight:bold}
		.mdui-dialog.mdui-noemail-dialog > .mdui-dialog-title + .mdui-dialog-content{font-size:14px;color:#181818;padding:0 15px 10px 15px}
		.mdui-dialog.mdui-noemail-dialog > .mdui-dialog-title + .mdui-dialog-content > p > span{display:block;margin-left:50px;font-size:13px}
		.mdui-dialog{width:85%}
		@media (min-width: 600px){
			.mdui-dialog{width:60%}
			.mdui-dialog.mdui-noemail-dialog > .mdui-dialog-title + .mdui-dialog-content > p > span{display:inline-block;margin-left:20px}
		}
		.scrape-together-reminder{text-align: center;color: #B4272D;position: fixed; right: 0; top: 50px; left: 0;max-width: 750px; margin: 0px auto; background: #F7E9EA; height: 30px; line-height: 30px; padding: 0px 4%; box-sizing: border-box;z-index: 1; cursor: pointer;font-size: 12px;box-shadow: inset 0 0 0 0 #DFDEDB;}
		.scrape-together-reminder img {width: 15px;height: 15px;vertical-align: middle;margin-top: -5px;}
		.scrape-together-reminder i{font-weight: 700;font-style: normal}
		body.mdui-bottom-nav-fixed{padding-bottom: 96px}
		input{-webkit-user-select: text;}

		div.card{margin: 10px 2.1% 0;border-radius: 6px;overflow: hidden}

		.StripeElement {box-sizing: border-box;height: 40px;padding: 10px 12px;border: 1px solid transparent;border-radius: 4px;background-color: white;box-shadow: 0 1px 3px 0 #e6ebf1;-webkit-transition: box-shadow 150ms ease;transition: box-shadow 150ms ease;}
		.StripeElement--focus {box-shadow: 0 1px 3px 0 #cfd7df;}
		.StripeElement--invalid {border-color: #fa755a;}
		.StripeElement--webkit-autofill {background-color: #fefde5 !important;}

		#tip-info{position: fixed;top: 52%;text-align: center;font-size: 14px;color: #fff;z-index: 10001;left: 0;right: 0}

		/* 購物車 */
		.mdui-cart-products-container{padding-bottom: 100px;}
		.mdui-cart-products{background: #FFFFFF;border-radius: 6px; padding: 15px 0;}
		.mdui-cart-products .mdui-list-item{padding: 0;font-size: 0;flex-wrap: wrap;margin-bottom: 24px; border: 0;}
		.mdui-cart-products .mdui-list-item:last-child{margin-bottom: 0;}
		.mdui-cart-products .mdui-list-item:after{height: 0}
		.mdui-cart-products .mdui-list-item.gift-item{padding-bottom: 6px}
		.mdui-cart-products .mdui-list-item .mdui-list-item-remark{display: block;width: 100%;color: #BCBCBC;line-height: 10px;margin-top: 8px}
		.mdui-cart-products .mdui-list-item .mdui-list-item-remark span{font-size: 12px;display: block;transform: scale(0.8);}
		.mdui-cart-products .mdui-list-item .swiper-wrapper .swiper-slide{display: flex;align-items: center;}
		.mdui-cart-products .mdui-list-item:hover{background-color: initial;}
		.mdui-cart-products .mdui-list-item .check-icon,
		.mdui-cart-products .mdui-list-item .exchange-check{width: 20px; height: 20px;padding:9px;}
		.mdui-cart-products .mdui-list-item .mdui-list-item-title{font-size: 14px; color: #000;height: 18px}
		.mdui-cart-products .mdui-list-item .mdui-list-item-title .mdui-list-item-promotion-tags-depletion{display: inline-block;border-radius: 8px;height: 16px;padding: 3px 4px;box-sizing: border-box;background: rgba(242, 143, 45, .1);color: #F56207;margin-right: 3px;}
		.mdui-cart-products .mdui-list-item .mdui-list-item-title .mdui-list-item-promotion-tags-depletion span{font-size: 12px;display: block;text-align: center;transform: scale(0.8);line-height: 10px;}
		.mdui-cart-products .mdui-list-item .mdui-list-item-text{font-size: 12px; color: #7B7B7B;height: 12px;margin-top: 8px}
		.mdui-cart-products .hasNone{font-size: 12px;background: #777;padding:4px;color: #fff;border-radius: 4px;position: relative;width:30px;text-align:center;}
		.mdui-cart-products .mdui-list a{margin-left:4px;}
		.mdui-cart-products .mdui-cart-product-sku-img{width: 80px; height: 80px; margin-right: 10px;vertical-align: middle;}
		.mdui-cart-products .mdui-cart-product-sku-info{width: calc(100% - 130px); height: 80px;position: relative; top: 0px;float: right;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2{position: absolute; width: 100%; bottom: 0px;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2 .mdui-list-item-text-price{font-size: 14px; color: #B4272D;position: absolute;bottom: 0;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2 .mdui-list-item-text-price .original-price{font-size: 12px; color: #7B7B7B;text-decoration: line-through;padding-left: 2px}
		/* iPhone6 */
		@media(max-width: 375px) {
			.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2 .mdui-list-item-text-price .original-price {
				font-size: 14px;
				color: #7B7B7B;
				text-decoration: line-through;
				padding-left: 0px;
				display: block;
			}
		}
		.mdui-cart-products .delete-icon{width: 22px; height: 22px; position: relative; top: 2px; margin-right: 18px;}
		.mdui-cart-products .mdui-list{padding: 0px 12px !important;}
		.mdui-cart-products .mdui-list > .mdui-divider-inset{height: 8px; margin: 0px !important; background: #F4F4F4;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags{display: inline-block;border-radius: 8px;height: 16px;padding: 3px 4px;box-sizing: border-box;background: rgba(180, 39, 45, .1);color: #B4272D;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-promotion-tags span{font-size: 12px;display: block;text-align: center;transform: scale(0.8);line-height: 10px;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2.promotion-text{bottom: 4px;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2.promotion-text .promotion-num{font-size: 12px ;color: #7B7B7B;}
		.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2.promotion-text .mdui-list-item-text-price{top: 0px;}
		.mdui-cart-products .mdui-cart-products-bottom{margin: 0 0 0 4%;padding-right: 4%; margin-left: calc(4% + 35px); height: 40px; line-height: 40px; border-top: 1px solid #EDEDED; cursor: pointer;}
		.mdui-cart-products .mdui-cart-products-bottom .mdui-float-right{color: #B4272D;}
		.mdui-cart-products .mdui-cart-products-bottom .mdui-float-right .mdui-icon{color: #B4272D; margin-top: -2px;margin-right: -10px;}
		.mdui-cart-products .swiper-container{width: 100%;}
		.mdui-cart-products .swiper-slide.menu{font-size: 14px;min-width: 80px; width: 20% ; max-width: 100px;background: #dd524d; color: #FFF; height: 80px; display: flex; justify-content: center; align-items: center;margin-left: 4px;}
		
		/* .mini-cart{z-index: 5099;}
		.mini-cart .view-bottom-head{border-bottom: 1px solid #EDEDED;}
		.mini-cart .view-bottom-head span{color: #F28F2D; font-size: 14px}
		.mini-cart .view-bottom-head button{display: inline-flex; align-items: center;}

		.mini-cart .view-bottom-footer{display: flex; align-items: center; padding: 0;box-shadow:0px -1px 0px 0px rgba(237,237,237,1);}
		.mini-cart .info{flex: 1;padding: 0 16px; height: 50px;display: flex;flex-direction: column;justify-content: center;}
		.mini-cart .info div:first-child{font-size: 12px; line-height: 12px; color: #B4272D;}
		.mini-cart .info div:last-child{font-size: 10px; line-height: 10px; color: #7B7B7B;padding-top: 4px;}
		.mini-cart .info div span{font-size: 22px; line-height: 22px;}
		
		.mini-cart #buyNow{height: 50px; width: 36%; border-radius: 0px;line-height: 50px; border: 0;}
		.mini-cart #buyNow.no-active{background-color: #EF9A9A !important;}
		.mini-cart #buyNow:active{opacity: 1;} */
		.empty-carts{text-align: center;height: 260px; background: #FFF; box-sizing: border-box; padding-top: 70px;}
    	.empty-carts .cart-img-empty{display: block; margin: 0px auto;width: 24%; max-width: 100px;}
    	.empty-carts .cart-tip-empty{display: block;color: #7B7B7B; padding: 16px 0px;}
    	.empty-carts .cart-empty-to-buy{border: 1px solid #B4272D;border-radius: 2px;color: #B4272D;line-height: 14px; width: 110px; height: 30px; line-height: 30px; background: #FFF;}
    	.empty-carts .mdui-page-bottom{background: #FFF;position: absolute; bottom: 0px;width: 100%;max-width: 750px;}
    	
		.delete-confirm{width: 84%;}
		.delete-confirm .mdui-dialog-content .mdui-cart-product-sku-img{width: 80px; height: 80px; margin-right: 10px;}
		.delete-confirm .mdui-dialog-content .mdui-cart-product-sku-info{width: calc(100% - 90px); height: 90px;position: relative; top: 0px;float: right;}
		.delete-confirm .mdui-dialog-content .mdui-cart-product-sku-info .mdui-list-item-title{font-size: 14px; color: #363636; margin-top: 12px;}
		.delete-confirm .mdui-dialog-content .mdui-cart-product-sku-info .mdui-list-item-text{font-size: 12px; color: #7B7B7B; margin-top: 12px;}
		.delete-confirm .mdui-dialog-title{text-align: center;}
		.delete-confirm .mdui-dialog-actions{padding: 0px; display: flex;}
		.delete-confirm .mdui-dialog-actions .mdui-btn{margin: 0px; padding: 0px; width: 50%;background: #FAFAFA; height: 48px; line-height: 48px; border-top: 1px solid #EDEDED;color: #7B7B7B;font-size: 16px;}
		.delete-confirm .mdui-dialog-actions .mdui-btn:first-child{border-right:1px solid #EDEDED;color: #B4272D;}

		.mdui-numbox{display: inline-block;position: relative;width: 100px;height: 28px;border: 1px solid #EDEDED;border-radius: 2px;color:#363636;}
		.mdui-numbox .mdui-numbox-btn i{top:50%;left: 50%;margin-left: -8px;margin-top: -8px;position: absolute;}
		.mdui-numbox .mdui-numbox-btn{width:28px;height:28px;border:none;background:#FFF;outline:none;position:absolute;top:0;cursor: pointer;}
		.mdui-numbox .mdui-numbox-btn .mdui-icon{font-size: 16px; color: #363636;}
		.mdui-numbox .mdui-numbox-input{font-size: 14px;width:100%;height:100%;margin:0;overflow:hidden;text-align:center;text-overflow:ellipsis;word-break:normal;border:none;outline:none;padding:0;text-align:center;}
		.mdui-numbox .mdui-numbox-btn-minus{left:0;border-right:1px solid #EDEDED}
		.mdui-numbox .mdui-numbox-btn-plus{right:0;border-left:1px solid #EDEDED}
		
		@media (min-width: 600px){
			.mdui-dialog{width:60%}
			.mdui-dialog.mdui-noemail-dialog > .mdui-dialog-title + .mdui-dialog-content > p > span{display:inline-block;margin-left:20px}
		}
		
		/*適配iphone5*/
		@media (max-width: 320px){
			.mdui-cart-products .mdui-cart-product-sku-img{width: 64px; height: 64px;}
			.mdui-numbox{width: 85px;}
			.mdui-cart-products .mdui-cart-product-sku-info{width: calc(100% - 109px); height: 64px;}
			.mdui-cart-products .mdui-cart-product-sku-info .mdui-list-item-text2 .delete-icon{margin: 0px 4px;}
			.mdui-cart-products .swiper-slide.menu{height: 64px;}
			.mdui-card-aggregation > .mdui-card-product-content .mdui-card-product{width: 110px;}
			.mdui-card-aggregation > .mdui-card-content{height: 190px;}
			.mdui-card-aggregation .mdui-card-product-content .mdui-card-product{width: 100px;}
		}
		
		@media (min-width: 750px){
			.delete-confirm{width: 60%;}
			.mdui-card-aggregation .mdui-card-product-content .mdui-card-product{width: 180px;}
			.mdui-card-aggregation > .mdui-card-content{height: auto;}
		}
		.mdui-cart-promotion-container{background: #FFFCEE;padding: 8px 2% 8px 4%;display: none;}
		.mdui-cart-promotion-container a{color: #F28F2D;font-size: 14px;text-decoration: none;display: flex;justify-content: space-between;align-items: center;}

		.mdui-overlay{background: transparent;}
		.mdui-overlay::after{content: '';width: 160px; height: 70px; top: 30%; left: 50%; margin-left: -80px; margin-top: 80px;border-radius: 10px; position: fixed;background:rgba(0,0,0,.7)}

        .top-right-options a.text-icon-options{margin-left: 0px !important;}
		.mdui-toolbar-title{ padding: 0px 8px 0 16px;}
		.similar-numbox{
			width: auto;height: 26px;border-radius: 100px;color: #B4272D;border: 1px solid #B4272D;line-height: 26px;
		}
		.similar-numbox a{
			display:block;padding: 0 20px 0 10px;
		}
		.similar-numbox i.right{
			width: 10px;position: absolute;top: 8px;right: 8px;
		}
		.similar-numbox i.right img{
			display:block;width:100%;height:100%;
		}
		.similar{
			font-size:14px;
		}
	</style>
	<script>
		var montiorTime={start:0,end:0};function setStart(){montiorTime.start=(new Date).getTime()}function setEnd(){montiorTime.end=(new Date).getTime(),cacheSessionStorage.setCache("montiorTime",{aimsFromUrl:location.href,params:[montiorTime]})}
	</script>
</head>
<body class="mdui-bottom-nav-fixed mdui-appbar-with-toolbar mdui-loaded" onload="setStart()" onbeforeunload="setEnd()" style="padding: 0;">
    <div class="mdui-appbar mdui-appbar-fixed mdui-shadow-0">
		<div class="mdui-toolbar-title" style="height: 50px; line-height: 50px;">
			<div class="top-left-options">
				<div class="view-bottom-head">
                    <span class="price_top" style="font-size: 16px;"></span>
                </div>
			</div>
            <div class="top-right-options" onclick="tools.goBack();">
                <span class="view-bottom-head-text" style="color:#F28F2D;font-size:16px;font-weight:500;margin-right: 5px;"></span>
				<a  class="text-icon-options" href="javascript:void(0)"   >  <img src="../image/icon-close3.png" style="width: 20px;"></a>
			</div>
		</div>
	</div>
	<div class="mdui-cart-products-container"></div>

	<div class="mdui-bottom-nav">
		<div class="mdui-row mdui-color-white">
			<div style="width: 200px;float: left;">
				<div class="info" style="line-height: 50px;">
					<span style="font-size: 14px;">合計: </span></span><span style="font-size:14px;">HK$</span>0
					
				</div>
				 <div style="width: 200px;padding-left: 16px;color:#7B7B7B" class="seeDetail">
					<span id="seeDetail-text" style="color: #7B7B7B;font-size: 12px;"></span>
<!--					 <img src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon/icon-top.png" width="11px" alt="">-->
				</div>
			</div>
			
			<button id="buyNow" class="mdui-btn mdui-btn-block mdui-color-red-900"><span></span><span>去結賬</span></button>
		</div>
		
	</div>




	<!-- <div class="scrape-together-reminder">
		<span><img src="../image/icon/icon-caveat.png" /> 因新春物流停運 1.25日之後的訂單 延遲到2.21日後發貨</i></span>
	</div> -->
	<div class="selectDetail view-bottom" style="bottom: 50px !important;">
		<div class="view-bottom-box view-bottom-box-sml" style="height: 220px;top:calc(100% - 220px)">
			<div class="view-bottom-head">
				<button class="success" style="opacity: 0;">確認</button>
				<span>合計明細表</span>
				<button class="closeDetail"><img src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon/icon-close2.png" class="close-pub"></button>
			</div>
			<div class="view-bottom-content" >
				<div class="mdui-color-white mdui-pannel mdui-pay-info card" style="padding: 0;margin: 0;">
					<ul class="mdui-list" style="padding: 0;" >
						<li class="mdui-list-item">
							<span class="orderProCount">商品合計(0)</span>
                        </li>
                        <li class="mdui-list-item">
							<span >合計總金額</span>
							<div class="orderPay">···</div>
						</li>
						<li class="mdui-list-item orderDiscountDepletion" style="display: none">
							<span class="label">活動優惠</span>
							<div ></div>
						</li>
						<li class="mdui-list-item" style="margin-top: 5px;">
							<span class="label">運費</span>
							<div class="orderExpressCount">···</div>
                        </li>
                        <div id="detail-list" style="margin-top: 10px;">

						</div>
						<div style="color:#777777;font-size: 12px;">金額數值為限時出清價和8折價的差價</div>
					</ul>
				</div>	
			</div>
		
		</div>
	</div>




	
</body>
<script src="https://d3o2c7bn83e5x8.cloudfront.net/dist/mdui/js/mdui.js"></script>
<script src="https://d3o2c7bn83e5x8.cloudfront.net/dist/art-template/lib/template-web.js"></script>
<script src="https://d3o2c7bn83e5x8.cloudfront.net/js/jquery-2.1.0.js"></script>
<script src="https://d3o2c7bn83e5x8.cloudfront.net/dist/Swiper/js/swiper.js"></script>
<!-- <script src="https://js.stripe.com/v3/"></script> -->
<script src="https://d3o2c7bn83e5x8.cloudfront.net/dist/city-picker/js/city-picker.data.js"></script>
<script src="https://d3o2c7bn83e5x8.cloudfront.net/dist/city-picker/js/city-picker.js"></script>
<!-- <script src="https://d3o2c7bn83e5x8.cloudfront.net/js/data.js?v=20190911"></script> -->
<!-- Global site tag (gtag.js) - Google Analytics -->
<script src="../js/common.js?v=2020110500"></script>
<script>
	commonConfig.addUtJsAsync('https://www.googletagmanager.com/gtag/js?id=' + commonConfig.getGATracking());
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag("config",commonConfig.getGATracking());
	if(commonConfig.getGATracking() != 'UA-117174835-7'){
		gtag("config",'UA-117174835-7');
	}
</script>
<script>
  !function(e,n,t,o,c,a,f){e.fbq||(c=e.fbq=function(){c.callMethod?c.callMethod.apply(c,arguments):c.queue.push(arguments)},e._fbq||(e._fbq=c),c.push=c,c.loaded=!0,c.version="2.0",c.queue=[],(a=n.createElement(t)).async=!0,a.src="https://connect.facebook.net/en_US/fbevents.js",(f=n.getElementsByTagName(t)[0]).parentNode.insertBefore(a,f))}(window,document,"script"),fbq("init",commonConfig.getFbPiexId()),fbq("track","PageView");
</script>
<script id="all-cart-products" type="text/html">
	<div class="mdui-cart-products">
		<div class="mdui-list">
		<% for (var i = 0; i < list.length; i++) { %>
			<img class="mdui-cart-product-sku-img" src="<%=list[i].productImageUrl%>">
			<% if(list[i].presents && list[i].presents.length > 0){ %>
				<% for (var j = 0; j < list[i].presents.length; j++) { %>
					<img class="mdui-cart-product-sku-img" src="<%= list[i].presents[j].productImageUrl %>">
				<% } %>
			<% } %>
		<% } %>
		</div>
	</div>
	<span>共<%= $imports.productsNum(list) %>件<i class="mdui-icon material-icons mdui-text-color-grey-500 array-right" style="margin-right: -10px;">keyboard_arrow_right</i></span>
</script>
<script id="normal-cart-products" type="text/html">
	<div class="mdui-cart-products">
		<ul class="mdui-list">
			<% for (var i = list.length-1; i >= 0; i--) { %>
				<% if(!list[i].soldOut){ %>
					<li class="mdui-list-item" productid="<%=list[i].productId%>" productskuid="<%=list[i].productSkuId%>" discountprice="<%= list[i].discountPrice %>">
						<div class="swiper-container">
							<div class="swiper-wrapper">
								<div class="swiper-slide content">
									<% if(list[i].isSelect){ %>
										<img class="check-icon active" src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon_check.png" data-skuid="<%= list[i].productSkuId %>" data-productid="<%= list[i].productId %>">
									<% }else{ %>
										<img class="check-icon" src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon_no_check.png" data-skuid="<%= list[i].productSkuId %>" data-productid="<%= list[i].productId %>">
									<% } %>
									<a href="../product/index.html?id=<%=list[i].productId%>">
										<img class="mdui-cart-product-sku-img" src="<%=list[i].productImageUrl%>">
									</a>
									<div class="mdui-cart-product-sku-info">
										<div class="mdui-list-item-title mdui-list-item-one-line">
											<%=list[i].productTitle%>
										</div>
										<div class="mdui-list-item-text mdui-list-item-one-line"><%=list[i].productSkuName%></div>
										
										<div class="mdui-list-item-text2">
											<span class="mdui-float-left mdui-list-item-text-price">
												<% if(list[i].shoppingType == 1){ %>
													<span style="color:#222222">HK$<%= list[i].price %></span>	
												<% } %>
					
												<% if(list[i].shoppingType == 2){ %>
													<span>HK$<%= list[i].price %></span><span class="original-price" >HK$<%= list[i].originalPrice %></span>
												<% } %>
											</span>
											<div class="mdui-float-right">
												<img class="delete-icon" src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon/icon-del.png">
												<div class="mdui-numbox" data-numbox-step="1" data-numbox-min="1" data-numbox-max="999" data-skuid="<%= list[i].productSkuId %>" data-productid="<%= list[i].productId %>">
													<button class="mdui-numbox-btn mdui-numbox-btn-minus"><i class="mdui-icon material-icons">remove</i></button>
													<input class="mdui-numbox-input" type="number" value="<%=list[i].quantity%>" readonly="" onfocus="this.blur()">
													<button class="mdui-numbox-btn mdui-numbox-btn-plus"><i class="mdui-icon material-icons">add</i></button>
												</div>
											</div>
										</div>
									</div>
								</div>
								<div class="swiper-slide menu">刪除</div>
							</div>
						</div>
					</li>
				<% } %>
			<% } %>
			<!-- 已经下架的需置后 -->
			<% for (var i = list.length-1; i >= 0; i--) { %>
				<% if(list[i].soldOut){ %>
					<li class="mdui-list-item" productid="<%=list[i].productId%>" productskuid="<%=list[i].productSkuId%>" discountprice="<%= list[i].discountPrice %>" discounttotalprice= "<%= list[i].discountTotalPrice %>">
						<div class="swiper-container">
						  <div class="swiper-wrapper">
							  <div class="swiper-slide content">
								  <span class="hasNone">售罄</span>
								  <a href="../product/index.html?id=<%= list[i].productId %>&hascache=hascache" style='margin-left:4px;'>
										<img class="mdui-cart-product-sku-img" src="<%=list[i].productImageUrl%>">
									</a>
									<div class="mdui-cart-product-sku-info">
										<div class="mdui-list-item-title mdui-list-item-one-line" style="opacity:0.5;">
											<%=list[i].productTitle%>
									  </div>
									  <div class="mdui-list-item-text mdui-list-item-one-line" style="opacity:0.5;"><%=list[i].productSkuName%></div>
										<div class="mdui-list-item-text2">
										  <span class="mdui-float-left mdui-list-item-text-price">
											<span style="color:#222222;opacity:0.5;">HK$<%= list[i].price %></span>
										  </span>
											<div class="mdui-float-right">
												<img class="delete-icon" src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon/icon-del.png">
												<div class="mdui-numbox similar-numbox" data-numbox-step="1" data-numbox-min="1" data-numbox-max="999" data-skuid="555" data-productid="423">
													<a href="/shop/similarPro.html?id=<%= list[i].productId %>">
														<span class='similar'>找相似</span>  
														<i class='right'><img src="../image/icon-join-right.png" alt=""></i>
													</a>
												</div>
											</div>
										</div>
									</div>
							  </div>
							  <div class="swiper-slide menu">刪除</div>
						  </div>
					  </div>
					</li>
				<% } %>
			<% } %>
			
		</ul>
	</div>
</script>
<script type="text/javascript">
	var app = {
		datas : {
			pinto: tools.getURLParam('pinto'),
			orderProducts: getCache('orderProducts'),
			_price: {},
			postageFreePrice : 200,
			address : getCache('dataCacheAddress-address'),
			dom_home: {
	            _username: $$('.addressView .address-home input[name="username"]'),
	            _phone: $$('.addressView .address-home input[name="phone"]'),
	            _adressDetails: $$('.addressView .address-home input[name="adressDetails"]'),
	            _email: $$('.addressView .address-home input[name="email"]'),
			},
			dom_market: {
	            _username: $$('.addressView .address-market input[name="username"]'),
	            _phone: $$('.addressView .address-market input[name="phone"]'),
	            _market: $$('.addressView .address-market .selectSuperMarket div.typeMes > div'),
	            _adressDetails: $$('.addressView .address-market .selectSuperMarket div.marketDetail'),
			},
			commentDom:{
				open: $$('.open-comments'),
				write: $$('.write-comments'),
				done: $$('.done-comments'),
			},
			marketSelect:{
				cityindex: null,
				townindex: null,
				marketType: null
			},
			couponCode:'',
			payType: '',
			adlk: cacheCookie.getCache("adlk")
		},
		data: {
			leftTime: 999,
			cartTime: 999,
			timeout_interval: null,
		},
		methods : {
			initCartProducts : function(){
				//1.判断来源,是否有收货人, 
				if(tools.getURLParam('consignee') && tools.getURLParam('consignee') != ''){
					var address = {
						userame: tools.getURLParam('consignee'),
						phone: tools.getURLParam('tel'),
						adressDetails: tools.getURLParam('detail'),
						email: tools.getURLParam('email'),
						district: tools.getURLParam('district'),
						city: tools.getURLParam('city'),
						sex: tools.getURLParam('sex'),
						type: 'byCare'
					};
					cacheCookie.setCache('affiliate', 'care', 1)
					cacheCookie.setCache('pixelId', commonConfig.fbPiexId, 1)
					cacheCookie.setCache('adlk', '', 0);
					setCache("dataCacheAddress-address", address);
					window.location.href = '../shop/index.html'
				}
				// 2.判断是否有数据需要处理
				app.methods.initPayNum();
			},
			// 解決安卓低版本facebook瀏覽器會遮住底部的問題
			androidFbbrower: function(){
				// 新增
				if(tools.getPlatform() == 'Android' && tools.getBrowerForm() == 'FB'){
					$$('.mdui-bottom-nav').css({
						'padding-bottom': '50px'
					})
					$$('.mdui-cart-products-container').css({
						"padding-bottom": '100px'
					})
				}
			},
			setEmpty: function(){
				// 处理为空表购物车
				var emptyHtml = '<div class="empty-carts">'+
							'	<img class="cart-img-empty" src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon-cart-empty.png">'+
							'	<span class="cart-tip-empty">您還沒有添加任何商品喲</span>'+
							'	<a href="'+ (app.datas.pinto == 'true' ? 'javascript:void(history.go(-1))' : '../shop/index.html') +'" class="mdui-btn cart-empty-to-buy">'+ (app.datas.pinto == 'true' ? '繼續購物' : '去逛逛') +'</a>'+
							'</div>'
				$('.mdui-address').remove()
				$('.mdui-cart-products-container').remove()
				$('.mdui-pay-info').remove()
				$('.open-comments').remove()
				$('.mdui-cart-comments').remove()
				$('.mdui-bottom-nav > div').eq(0).remove()
				$('.mdui-bottom-nav').css({
					height: 'auto'
					// height: '0px'
				})
				// $('.scrape-together-reminder').css({
				// 	bottom: '0px'
				// })
				$('body').append(emptyHtml).css({
					background: '#fff',
					'padding-top': '40px',
				})
				$('html').css({
					background: '#fff'
				})
				// window.location = '../shop/index.html';
				$$('.mdui-cart-promotion-container').hide()
				if(app.datas.pinto == 'true'){
					$$('.mdui-bottom-nav').hide()
				}
				setCache("orderProducts", []);
				app.datas.orderProducts = []
				return
			},
			setEmpty2: function(){
				// $('.mdui-address').remove()
				// $('.mdui-cart-comments').remove()
				// console.log($('.mdui-bottom-nav').html())
				$('.mdui-bottom-nav').remove()
			},
			initPayNum: function(changge){
				//調用後臺API校驗數據合法性,校驗完成後,還需要重新寫入到cookies中去.
				// 針對已經下架的商品重新處理提交的參數
				let neworderProducts = app.datas.orderProducts || [],neworderProducts2=[],neworderProducts3=[]
				neworderProducts.map((item, index) => {
					delete item.soldOut
				})
				var data = {
					orderProducts : neworderProducts,
				}
				if(app.datas.couponCode && app.datas.couponCode != ''){
					data.couponCode = app.datas.couponCode
				}
				if(!app.datas.orderProducts || app.datas.orderProducts.length == 0){
					$$('.view-bottom-head .price_top').html('購物車')
					$$('.view-bottom-head .price_top').css({
						"font-size":'16px',
						"color":"#7B7B7B"
					})
					app.methods.setEmpty()
					return
				}
				$$.ajax({
					method: 'POST',
					url: commonConfig.websitePrefix() + '/api/free-shipping/order/price',
					contentType : "application/json ; charset=utf-8",
					data: JSON.stringify(data),
					beforeSend : function (xhr){
						tools.loading();
						// 存滚动位置
						app.data.scrollTop = document.documentElement.scrollTop || document.body.scrollTop
					},
					success: function(e) {
						if("OK" == e.statusCode){ 
							if(e.body.products.length == 0){
								app.methods.setEmpty()
								return
							}
							// if (changge === 'change') {
							// 	setCache("orderProducts", e.body.products);
							// }else{
							// 	setCache("orderProducts", e.body.products.reverse());
							// }
							setCache("orderProducts", e.body.products);
							app.datas.orderProducts = e.body.products
							app.datas._price = e.body.price;
							$$('.mdui-cart-products-container').html('');

							var _narmalProducts = {name : 'normalProduct' , list : []};
							$$.each(app.datas.orderProducts, function(index , orderProduct) {
								if(!orderProduct.quantity) orderProduct.quantity = 1;
								if(!orderProduct.presents){
									_narmalProducts.list.push(orderProduct);
								}
							});
							if(_narmalProducts.list.length > 0)$$('.mdui-cart-products-container').prepend(template('normal-cart-products', _narmalProducts));
							
							// 加载上部标题
							app.cart.initTopTip();
							// 初始化數字選擇框
							app.cart.initMduiNumbox();
							// 初始化刪除圖標刪除事件
							app.cart.initProductDelete();
							// 初始化radio事件
							app.cart.initProductListItemClick();
							// 處理[立即購買]按鈕事件
							app.cart.initbuyNowAction();

							// 计算
							$$(".mdui-bottom-nav .info").html("<span>商品合計:</span> <span style='font-size:14px;'>HK$</span><span class='allPrice'>" + (e.body.price.discountTotalPrice) + " </span><span> </span>")
                            var shoppingcartNum = tools.getShopCartProductsNum()
							var shoppingcartShow = tools.getShopCartProductsShow()
							$$(".seeDetail").css("display","block")
							$$(".info").css("line-height","1.15")
							if(app.datas._price.discountTotalPrice > 0){
								if (app.datas._price.discountTotalPrice < 200&&shoppingcartShow) {
									// 8折价，不满200
									$$('.view-bottom-head .price_top').html('再買HK$' + (app.datas.postageFreePrice - app.datas._price.discountTotalPrice) + '，可享8折價')
									$$('.view-bottom-head-text').html('繼續逛  ')
									$$('.view-bottom-head .price_top').css({
										"color":"#F28F2D",
										"font-size":"16px",
										"font-weight":"500"
									})
									$$("#seeDetail-text").text('未滿HK$200，結算時需補HK$' + app.datas._price.spreadPrice)
									// $$('#detail-list').html('<li class="mdui-list-item"><span class="label">金額未滿HK$200，需補差價</span><div>+ $'+app.datas._price.spreadPrice+'</div></li>') 
								} else if (app.datas._price.discountTotalPrice >= 200&&shoppingcartShow) {
									// 8折价，满200
									$$('.view-bottom-head .price_top').html('已享8折價')
									$$('.view-bottom-head-text').html('繼續逛  ')
									$$('.view-bottom-head .price_top').css({
										"color":"#F28F2D",
										"font-size":"16px",
										"font-weight":"500"
									})
									$$("#seeDetail-text").text('已滿HK$200，結算時需補HK$'+app.datas._price.spreadPrice)
									// $$('#detail-list').html('<li class="mdui-list-item"><span class="label">金額已滿HK$200，需補差價</span><div>+ $'+app.datas._price.spreadPrice+'</div></li>') 
								} else if (app.datas._price.discountTotalPrice < 200&&!shoppingcartShow){
									// 原价，不满200
									// $$('.view-bottom-head .price_top').html('再買$' + (app.datas.postageFreePrice - app.datas._price.discountTotalPrice) + '，可免運')
									$$('.view-bottom-head .price_top').html('已免運')
									$$(".seeDetail").css("display","block")
									$$('.view-bottom-head-text').html('繼續逛  ')
									$$('.view-bottom-head .price_top').css({
										"color":"#F28F2D",
										"font-size":"16px",
										"font-weight":"500"
									})
									$$("#seeDetail-text").text('未滿HK$200，結算時需補HK$' + app.datas._price.spreadPrice)
									// $$('#detail-list').html('<li class="mdui-list-item"><span class="label">金額未滿HK$200，需補差價</span><div>+ $'+app.datas._price.spreadPrice+'</div></li>') 
								} else if (app.datas._price.discountTotalPrice >= 200&&!shoppingcartShow) {
									// 原价，满200
									$$('.view-bottom-head .price_top').html('已免運')
									$$('.view-bottom-head-text').html('繼續逛  ')
									$$('.view-bottom-head .price_top').css({
										"color":"#F28F2D",
										"font-size":"16px",
										"font-weight":"500"
									})
									$$("#seeDetail-text").text('已滿HK$200，結算時需補HK$' + app.datas._price.spreadPrice)
									// $$('#detail-list').html('<li class="mdui-list-item"><span class="label">金額已滿HK$200，需補差價</span><div>+ $'+app.datas._price.spreadPrice+'</div></li>') 
								}
							} else {
								 $$('.view-bottom-head .price_top').html('')
								 $$('.view-bottom-head-text').html('繼續逛  ')
								 $$("#seeDetail-text").text('未滿HK$200，需補HK$'+app.datas._price.spreadPrice)
								//  $$('#detail-list').html('<li class="mdui-list-item"><span class="label">金額未滿HK$200，需補差價</span><div>+ $'+app.datas._price.spreadPrice+'</div></li>') 
							}
                            
							var pro_pub_num = 0,
								discountLimitPub = 0,
								discountTimePub = 0,
								discountTotalCouponPrice = e.body.price.discountTotalCouponPrice || 0,
								discountPub = 0,
								discountDepletion = 0;
							e.body.products.map(function(e){
								// 總件數
								e.isSelect && (pro_pub_num += e.quantity)
								e.presents && (pro_pub_num += e.presents.length)	
								//失效商品处理
								if(!e.soldOut){
									neworderProducts2.push(e)
								}else{
									neworderProducts3.push(e)
								} 
							});
							discountPub = e.body.price.originalTotalPrice - e.body.price.discountTotalPrice - discountTimePub - discountLimitPub - discountTotalCouponPrice;
							discountDepletion = e.body.price.originalTotalPrice - discountPub;
                            $$(".mdui-pay-info .orderProCount").html('共' + pro_pub_num + '件商品')
							$$(".mdui-pay-info .orderPay").html("HK$" + e.body.price.discountTotalPrice)
							$$(".mdui-pay-info .orderExpressCount").html("HK$" + e.body.price.freight)
						   
							
						
							
                            // 优惠券优惠
							if(discountTotalCouponPrice > 0){
								$$('.couponDiscount .typeMes div').html('- HK$' + discountTotalCouponPrice).css('color','#F28F2D')
								$$('.typeMesDetail').css("display","flex")
								$$('.typeMesDetail div').html('- HK$' + discountTotalCouponPrice)
								gtag('event', 'clickUseCoupon');
							}else{
								$$('.couponDiscount .typeMes div').html('點擊輸入優惠碼號').css('color','#777')
								$$('.typeMesDetail').css("display","none")
							}
							tipWindow.bottomView.close($$('.inputCouponView'))
							// 出清優惠
							if(e.body.price.activityDiscountPrice > 0){
								$$(".mdui-pay-info .orderDiscountDepletion div").html('- HK$' + e.body.price.activityDiscountPrice);
								$$(".mdui-pay-info .orderDiscountDepletion").show();
							}else{
								$$(".mdui-pay-info .orderDiscountDepletion").hide();
							}

							if(e.body.price.eightDiscountPrice > 0){
								$$(".mdui-pay-info .orderDiscount div").html('- HK$' + e.body.price.eightDiscountPrice);
								$$(".mdui-pay-info .orderDiscount").show();
							}else{
								$$(".mdui-pay-info .orderDiscount div").html('- HK$' + 0);
								$$(".mdui-pay-info .orderDiscount").show();
							}


							if(data.couponCode){
								if(discountTotalCouponPrice == 0){
									$$('.inputCouponView .useCoupon > span').text('券碼無效！').css('color','#b71c1c');
									$$('.inputCouponView .useCoupon input').val('');
									app.datas.couponCode = null;
								}else{
									// $$('.inputCouponView .useCoupon > span').text('註：優惠碼號不可疊加使用').css('color','#9F8A60')
								}
                            }
							// 處理時效的商品
							if(neworderProducts2.length == 0 && neworderProducts3.length != 0){
								app.methods.setEmpty2()
							}
							// $$(".seeDetail").off().on("click",function(){
							// 	tipWindow.bottomView.open($$('.selectDetail'))
							// 	$$(".seeDetail").css("display","none")
							// 	$$(".info").css("line-height","50px")
							// })
							// $$(".closeDetail").off().on("click",function(){
							// 	tipWindow.bottomView.close($$('.selectDetail'))
							// 	$$(".seeDetail").css("display","block")
							// 	$$(".info").css("line-height","1.15")
							// })

							
						}else{
							mdui.snackbar({message: '網路繁忙,請重試...',position: 'top'});
						}
					},
					error: function(err){
						var errMes = JSON.parse(err.response)
						if(errMes && errMes.body && errMes.body.message){
							$$('.inputCouponView .useCoupon > span').text(errMes.body.message).css('color','#b71c1c');
						}
						$$('.inputCouponView .useCoupon input').val('');
						app.datas.couponCode = null;
					},
					complete: function (xhr, textStatus) {
						tools.hideLoading();
						// 加载滚动位置
						if(app.data.scrollTop != null){
							document.documentElement.scrollTop = app.data.scrollTop
							document.body.scrollTop = app.data.scrollTop
						}
					}
				});
			},
	        initSelectPayType : function(){
				$$('.mdui-bottom-nav #buyNow').off().on('click' , function(e){
					tipWindow.bottomView.close($$('.selectDetail'))
					$$(".seeDetail").css("display","block")
					// $$(".info").css("line-height","1.15")
					
					$$(".successToNext").text("確定支付 $"+$$(".mdui-bottom-nav .allPrice").text())
					var orderParamOrderProducts = [];
					app.datas.orderProducts.map(function(e){
						if(e.isSelect && !e.soldOut){
							orderParamOrderProducts.push(e)	
						}
					})
					if(orderParamOrderProducts && orderParamOrderProducts.length > 0){
                        window.location.href = "../shopcart/cart.html"
						
					}else{
						mdui.snackbar({message: '請選擇要購買的商品···',position: 'top'});							
						$$(this).addClass('no-active');
					}
				});
				// 打开选择付款方式盒子
				$$('.openPayType').off('click').on('click' , function(){
					// app.datas.process = '1'
					tipWindow.bottomView.open($$('.selectPayType'))
				})
				// 选择付款类型
				$$('.selectPayType ul .check-icon').off().on('click', function(){
					if(app.datas._price.discountTotalPrice>=2500){

						return false
					}
					if(!$$(this).hasClass('select')){
						// $$('.selectPayType ul .check-icon')
						$$(this).parent().siblings().find('.check-icon').attr('src','https://d3o2c7bn83e5x8.cloudfront.net/image/icon_no_check.png').removeClass('select')
						$$(this).attr('src','https://d3o2c7bn83e5x8.cloudfront.net/image/icon_check.png').addClass('select')
					}
				});
				// 点击行也可选择
				$$('.selectPayType ul li:not(.tips)').off().on('click', function(){
					$$(this).find('.check-icon')[0].click()
				});
				// 客服下单自动点击
				if(app.datas.address && app.datas.address.type == 'byCare'){
					$$('.selectPayType .check-icon[data-type="cash"]').trigger('click')
				}
				// 立即结账
				$$('.selectPayType .successToNext').off().on('click' , function(){
					// 存数据
					if($$('.selectPayType ul li .select').length == 0){
						return
					}
					app.datas.payType = $$('.selectPayType ul li .select').data('type');
					$$('.openPayType .typeMes div').html($$('.selectPayType ul li .select').next('.typeCon').text()).css({'color': '#000'});
					// 存数据
					gtag('event', 'clickPaymentType');
					tipWindow.bottomView.close($$('.selectPayType'))
					// if(app.datas.process == '0'){ // 0 點擊結賬后, 1 點擊選擇付款方式后
					// 	$$('.mdui-bottom-nav #buyNow').trigger('click')
					// }
					newMonitor.addMonitor({
						'eventAims': 'CHECKOUT',
						'eventName': 'CLICK',
						'aimsCategory': 'EVENT',
					});
					app.methods.payNow();
					
				});
				// 选择付款类型
				// $$('.openPayType ul li:not(.tip-stripe)').off().on('click', function(e){
				// 	if(!$$(this).find('.check-icon').hasClass('select')){
				// 		$$('.openPayType ul .check-icon').attr('src','https://d3o2c7bn83e5x8.cloudfront.net/image/icon_no_check.png').removeClass('select')
				// 		$$(this).find('.check-icon').attr('src','https://d3o2c7bn83e5x8.cloudfront.net/image/icon_check.png').addClass('select')
				// 	}
				// 	// 存数据
				// 	newMonitor.addMonitor({
				// 		'eventAims': 'PAYTYPE',
				// 		'eventName': 'CLICK',
				// 		'aimsCategory': 'EVENT',
				// 	});
				// 	gtag('event', 'clickPaymentType');
				// 	app.datas.payType = $$('.openPayType ul li .select').data('type');;
				// });
				// 默认选择stripe
				// $$('.openPayType ul li').eq(0).trigger('click');
			},
	        closeCardPay : function(){
				tipWindow.bottomView.close($$('.stripePay'))
				tipWindow.bottomView.open($$('.selectPayType'))
				tools.hideLoading();
			},
			loadJs: function (url, callback) {
				var script = document.createElement('script');
				script.type = "text/javascript";
				if (typeof (callback) != "undefined") {
					if (script.readyState) {
						script.onreadystatechange = function () {
							if (script.readyState == "loaded" || script.readyState == "complete") {
								script.onreadystatechange = null;
								callback();
							}
						}
					} else {
						script.onload = function () {
							callback();
						}
					}
				}
				script.src = url;
				document.body.appendChild(script);
			},
			stripSubmit: function(e){
				app.datas.stripe.stripe.createToken(app.datas.stripe.card).then(function(result) {
					if (result.error) {
						var errorElement = document.getElementById('card-errors');
						errorElement.textContent = result.error.message;
						tools.hideLoading();


						_this.$loading(false);
						e.preventDefault();
						return false
					}
					
				});
			},
           	hasProductPayed : function(products , productskuid){
           		var result = false;
           		$$.each(products , function(index , product){
           			if(product.productSkuId == productskuid){
           				result = true;
           				return false;
           			}
           		});
           		return result;
			},
           	initAddressView : function(){
           		$$('.mdui-address').off().on('click' , function(e){
					try {
						fbq("track", "Lead");
						gtag("event", "Lead");
					} catch (e) {
						console.log(e);
					}
					if(app.datas.address){
						switch(app.datas.address.addType){
							case 1: app.methods.initDefaultHome();break;
							case 2: app.methods.initDefaultMarket();break;
							case 3: app.methods.initDefaultMarket();break;
							default: app.methods.initDefaultHome();break;
						}
					}else{
						app.methods.initDefaultHome();
					}
					tipWindow.bottomView.open($$('.addressView'))
				});
				$$('.addressView .success').off().on('click' , function(e){
					return;
					var type = $$(this).text();
					switch(type){
						case '選超商取貨': app.methods.initDefaultMarket();break;
						case '選宅配': app.methods.initDefaultHome();break;
					}
				});
			},
			initDefaultHome: function () {
				$$('.addressView .address-home').show();
				$$('.addressView .address-market').hide();
				$$('.addressView .view-bottom-head .success').text('選超商取貨');
				// 初始化宅配
				app.methods.initaddressEvent();
				// 初始化值
	            if(app.datas.address && "" != app.datas.address){
					if(!app.datas.address.addType || app.datas.address.addType == 1){
						app.datas.dom_home._username.val(app.datas.address.userame);
						app.datas.dom_home._phone.val(app.datas.address.phone);
						app.datas.dom_home._adressDetails.val(app.datas.address.adressDetails);
						app.datas.dom_home._email.val(app.datas.address.email);
						$('.mdui-list-address .placeholder').hide()
						$('.mdui-list-address .title').html('<span class="select-item" data-count="province">'+app.datas.address.city+'</span>/<span class="select-item" data-count="city">'+app.datas.address.district+'</span>').show()
					}
				}
			},
			initDefaultMarket: function () {
				$$('.addressView .address-home').hide();
				$$('.addressView .address-market').show();
				$$('.addressView .view-bottom-head .success').text('選宅配');
				// 初始化商超取货
				app.methods.initSelectMarket();
				// 初始化值
				if(!app.datas.address){
					return;
				}
				if(app.datas.address.addType != 1 && app.datas.address && "" != app.datas.address){
					app.datas.dom_market._username.val(app.datas.address.userame);
					app.datas.dom_market._phone.val(app.datas.address.phone);
					app.methods.initMarketSelect(app.datas.address);
				}
			},
			initaddressEvent : function(){
				// 保存地址
				$$('.address-home .saveAddress').off().on('click', function(e){
					var address = {
						userame: app.methods.getUserName(app.datas.dom_home._username),
						phone: app.datas.dom_home._phone.val().replace(/\s+/g, ""),
						adressDetails: app.datas.dom_home._adressDetails.val().trim().replace(/\\/g,''),
						district: $$(".mdui-list-address .title .select-item[data-count='city']").html(),
						city: $$(".mdui-list-address .title .select-item[data-count='province']").html(),
						addType: 1
					};
					if (!address.userame){
						return false;
					}
					if (!/^[2|3|5|6|7|8|9][0-9]\d{6}$/.test(address.phone)){
						mdui.snackbar({message: "您輸入的電話格式有誤，請重新輸入...", position: "top"});
						return false;
					}
					if (!address.adressDetails || !address.city || !address.district){
						mdui.snackbar({message: "地址信息不完善...", position: "top"});
						return false;
					}
					app.datas.address = address;
					setCache("dataCacheAddress-address", address);
					tipWindow.bottomView.close($$('.addressView'))

					app.methods.initAddress();
					newMonitor.addMonitor({
						'eventAims': 'ADDRESS_HOME',
						'eventName': 'CLICK',
						'aimsCategory': 'EVENT',
					});
					// 地址填写完成
					fbq("track", "CompleteRegistration");
					gtag("event", "CompleteRegistration");
				});
			},
			initDefaultEvents : function(){
				//TODO 监测
				try{
					var _fbgaparams = cacheSessionStorage.getCache('_fbgaparams');
					var _realgaparams = cacheSessionStorage.getCache("_realgaparams");
					if(_fbgaparams){
						fbq('track', 'InitiateCheckout', _fbgaparams);
						gtag('event', 'InitiateCheckout', _fbgaparams);
						cacheSessionStorage.removeCache('_fbgaparams');
					}
					if(_realgaparams){
						gtag("event", "begin_checkout", _realgaparams);
						cacheSessionStorage.removeCache("_realgaparams");
					}
				}catch(e) {
					console.log(e);
				}
				var product_buy_now = cacheSessionStorage.getCache('product-buy-now');
				if(product_buy_now){
					newMonitor.addMonitor(product_buy_now);
					cacheSessionStorage.removeCache('product-buy-now');
				}
			},
			initPageStatus : function(){
				var status = tools.getURLParam('status');
				if(status && status == 'error'){
				    if(tools.getURLParam('message')){
				    	mdui.snackbar({message: '支付已取消,請重試...' , position: 'top'});
				    }else{
				    	mdui.snackbar({message: '支付尚未成功,請重試...',position: 'top'});
				    }
					history.replaceState(null, null , window.location.origin + window.location.pathname);
				}
			},
			initSelectMarket: function(){
				var selectMarketView = $$('.selectMarketView');
				var dom = {
					type: selectMarketView.find('.step1 li'),
					addData: selectMarketView.find('.step2 .selectAdd'),
					navData: selectMarketView.find('.step2 .breadNav')
				}
				dom['add'] = {
					city: dom.addData.find('.level_city'),
					town: dom.addData.find('.level_town'),
					market: dom.addData.find('.level_market'),
				},
				dom['nav'] = {
					type: dom.navData.find('.level_type'),
					city: dom.navData.find('.level_city'),
					town: dom.navData.find('.level_town'),
				}
				// 加载市
				app.methods.initSelectVal('city');
				// 关闭
				selectMarketView.off().on('click' , function(e){
					if(e.target.classList[1] == 'view-bottom'){
						tipWindow.bottomView.close($$('.selectMarketView'))
						selectMarketView.find('.view-bottom-box').removeClass('view-bottom-box-sml-to-min').removeClass('view-bottom-box-min-to-sml');
						selectMarketView.find('.step1').show();
						selectMarketView
							.find('.step2').hide()
							.find('.selectAdd ul').removeClass('showNext').removeClass('showPrev');
					}
				});
				// 选择type,加载市
				dom.type.off().on('click' , function(e){
					selectMarketView.find('.view-bottom-box').addClass('view-bottom-box-sml-to-min').removeClass('view-bottom-box-min-to-sml');
					selectMarketView.find('.step1').hide();
					selectMarketView.find('.step2').show();
					dom.add.city.addClass('show');
					var type = $(this).data('type');
					app.datas.marketSelect.marketType = $(this).data('type');
					// 渲染選擇店鋪
					dom.addData.find('ul').removeClass('showNext').removeClass('showPrev');
					dom.nav.type.find('img').attr('src','https://d3o2c7bn83e5x8.cloudfront.net/image/icon-market-' + app.datas.marketSelect.marketType + '.jpg');
					dom.nav.city.find('span').html('選擇市').addClass('noVal');
					dom.nav.town.find('span').html('選擇區').addClass('noVal');
					if(app.datas.marketSelect.marketType == '3'){
						dom.nav.type.find('span').html('7-11');
					}else if(type == '2'){
						dom.nav.type.find('span').html('全家');
					}
				});
				// 加载区
				dom.add.city.off().on('click', 'li', function(){
					dom.add.city.removeClass('show').find('li').removeClass('active');
					dom.add.town.removeClass('showNext').removeClass('showPrev').addClass('show');
					$(this).addClass('active');
					app.datas.marketSelect.cityindex = $(this).data('index');
					app.methods.initSelectVal('town');
					dom.nav.city.find('span').html($(this).html()).removeClass('noVal');;
				});
				// 加载店
				dom.add.town.off().on('click', 'li', function(){
					dom.add.town.removeClass('show').find('li').removeClass('active');
					if(dom.add.market.hasClass('showNext') && dom.add.market.hasClass('showPrev')){
						dom.add.market.removeClass('showNext').removeClass('showPrev').addClass('show');
					}else{
						dom.add.market.removeClass('showPrev').addClass('show');
					}
					$(this).addClass('active');
					app.datas.marketSelect.townindex = $(this).data('index');
					app.methods.initSelectVal('market');
					dom.nav.town.find('span').html($(this).html()).removeClass('noVal');;
				});
				// 确认收货商超
				dom.add.market.off().on('click', 'li', function(){
					dom.add.market.find('li').removeClass('active');
					$(this).addClass('active');
					var addType = app.methods.typeToMarket(app.datas.marketSelect.marketType);
					var market = marketData[app.datas.marketSelect.cityindex].town[app.datas.marketSelect.townindex]['markrt_' + addType][$(this).data('index')]; 
					app.datas.market = {
						adressDetails: market.addr,
						marketName: market.NAME,
						marketKey: market.pkey,
						city: marketData[app.datas.marketSelect.cityindex].city,
						district: marketData[app.datas.marketSelect.cityindex].town[app.datas.marketSelect.townindex].val,
						addType: app.datas.marketSelect.marketType
					}
					app.methods.initMarketSelect(app.datas.market);
					tipWindow.bottomView.close($$('.selectMarketView'))
				});
				// 返回类型
				dom.nav.type.off().on('click', function(){
					return
					if($(this).find('span').hasClass('noVal')){
						return false;
					}
					selectMarketView.find('.view-bottom-box').removeClass('view-bottom-box-sml-to-min').addClass('view-bottom-box-min-to-sml');
					selectMarketView.find('.step1').show();
					selectMarketView.find('.step2').hide();
					dom.addData.find('ul').removeClass('showNext').removeClass('showPrev').removeClass('show');
				});
				// 返回市
				dom.nav.city.off().on('click', function(){
					if($(this).find('span').hasClass('noVal')){
						return false;
					}
					dom.addData.find('ul').removeClass('show');
					dom.add.city.addClass('show');
					dom.add.town.addClass('showPrev');
					dom.nav.town.find('span').html('選擇區').addClass('noVal');
				});
				// 返回区
				dom.nav.town.off().on('click', function(e){
					if($(this).find('span').hasClass('noVal')){
						return false;
					}
					dom.addData.find('ul').removeClass('show');
					dom.add.town.addClass('show');
					dom.add.market.addClass('showPrev');
				});
				// 确认商超选择
				$$('.address-market .saveAddress').off().on('click', function(e){
					var address = {
						userame: app.methods.getUserName(app.datas.dom_market._username),
						phone: app.datas.dom_market._phone.val().replace(/\s+/g, ""),
					};
	            	if(app.datas.market && "" != app.datas.market){
						address = Object.assign(app.datas.market, address);
					}else{
						if(app.datas.address == null){
							mdui.snackbar({message: "請選擇取貨門市...", position: "top"});
							return false;
						}else{
							address = Object.assign(app.datas.address, address);
						}
					}
					if (!address.userame){
						return false;
					}
					if (!/^[2|3|5|6|7|8|9][0-9]\d{6}$/.test(address.phone)){
						mdui.snackbar({message: "您輸入的電話格式有誤，請重新輸入...", position: "top"});
						return false;
					}
					if (!address.marketKey || !address.marketName){
						mdui.snackbar({message: "請選擇取貨門市...", position: "top"});
						return false;
					}
					app.datas.address = address;
					setCache("dataCacheAddress-address", address);
					tipWindow.bottomView.close($$('.addressView'))
					app.methods.initAddress();
					newMonitor.addMonitor({
						'eventAims': 'ADDRESS_MARKET',
						'eventName': 'CLICK',
						'aimsCategory': 'EVENT',
					});
					// 地址填写完成
					fbq("track", "CompleteRegistration");
					gtag("event", "CompleteRegistration");
				});
				// 开始
				$$('.selectSuperMarket').off().on('click' , function(e){
					tipWindow.bottomView.open($$('.selectMarketView'))
					if(app.datas.market == undefined){
						dom.type.eq(0).trigger('click')
					}
				});
			},
			getUserName: function(name){
				var username = name.val().trim()
				var right_name = username.match(/^[A-Za-z0-9\u4e00-\u9fa5]+$/g);
				if (!username){
					mdui.snackbar({message: "請輸入收件人姓名...", position: "top"});
				}else if(!right_name){
					mdui.snackbar({message: "收货人姓名格式不正确...", position: "top"});
				}
				return right_name[0] || '';
			},
			initSelectVal: function(type){
				var box = $$('.selectMarketView .step2 .selectAdd');
				var html = '';
				var addType = app.methods.typeToMarket(app.datas.marketSelect.marketType);
				if(type == 'city'){
					marketData.map(function(e,i){
						html += '<li data-index="' + i + '">' + e.city + '</li>';
					});
				}else if(type == 'town'){
					marketData[app.datas.marketSelect.cityindex].town.map(function(e,i){
						if(!e['markrt_' + addType]){
							return;
						}
						var num = e['markrt_' + addType].length;
						if(num > 0){
							html += '<li data-index="' + i + '">' + e.val + '(' + num + ')</li>';
						}
					});
					if(html == ''){
						html = '<p>當前地址暫不支持，如有疑問請聯繫客服...<p>';
					}
				}else if(type == 'market'){
					var data = marketData[app.datas.marketSelect.cityindex].town[app.datas.marketSelect.townindex]['markrt_' + addType];
					if(data.length > 0){
						data.map(function(e,i){
							html += '<li data-index="' + i + '">' + e.NAME + '（' + e.pkey + '）' + '<i>' + e.addr + '</i>' + '</li>';
						});
					}else{
						html = '<p>當前地址暫不支持，如有疑問請聯繫客服...<p>';
					}
				}
				box.children('ul.level_' + type).html(html);
				(type == 'town' || type == 'market') && box.children('.level_' + type).addClass('showNext');
			},
			initMarketSelect: function(data){
				if(data.addType && data.marketName && data.marketKey){
					app.datas.dom_market._market.html('<img src="https://d3o2c7bn83e5x8.cloudfront.net/image/icon-market-' + data.addType + '.jpg" style="height: 20px;margin: 0 6px">' + data.marketName + '(' + data.marketKey + ')').css({'color':'#000'});
					app.datas.dom_market._adressDetails.html('<span>' + data.city + data.district + data.adressDetails + '</span>');
				}
			},
			typeToMarket: function(type){
				var addType;
				switch(type){
					case 3: addType = '711';break;
					case 2: addType = 'fm';break;
				}
				return addType;
			},
			typeToMarketMes: function(){
				var addType;
				switch(app.datas.address.addType){
					case 3: addType = '7-11' + app.datas.address.marketName + '店 ' + app.datas.address.marketKey;break;
					case 2: addType = app.datas.address.marketName + ' ' + app.datas.address.marketKey;break;
				}
				return addType;
			},
			getClick: function(){
				$$('.toHome').on('click', function(e){
					e.stopPropagation();
					cacheSessionStorage.setCache("i_to_home", {
						'eventAims': 'HOME_ICON',
						'eventName': 'CLICK',
						'aimsFromUrl': location.href,
						'aimsCategory': 'EVENT',
					});
				});
				$$('.toCart').on('click', function(e){
					e.stopPropagation();
					cacheSessionStorage.setCache("i_to_cart", {
						'eventAims': 'CART_ICON',
						'eventName': 'CLICK',
						'aimsFromUrl': location.href,
						'aimsCategory': 'EVENT',
					});
				});
			},
			initShoppingCart: function() {
				var shoppingCartDom = $$('.shop_cart_num'),
					shoppingcartNum = tools.getShopCartProductsNum();
				if(shoppingcartNum == 0){
					shoppingCartDom.hide();
				}else{
					shoppingCartDom.html(shoppingcartNum).show();
				}
			},
			initbuyNowTime: function(){
				var last_add_time = getCache('last_add_time');
				if(last_add_time && last_add_time != ''){
					$$('.cartTime').show()
					app.methods.initCountdownShort(last_add_time + configurationParameter.shopcart_countdown);
				}else{
					$$('.cartTime p:first-child').html('');
				}
			},
			initCountdownShort: function(end_time) {
				app.data.timeout_interval = null;
				if(app.data.cartTime > 0) {
					app.methods.circleNumberShort(end_time);
					app.data.timeout_interval = window.setInterval(function(){
						app.methods.circleNumberShort(end_time);
					}, 100);
				} else {
					window.clearInterval(app.data.timeout_interval);
				}
			},
			circleNumberShort: function(endTime) {
				if(!endTime || endTime == null){
					$$('#buyNow').html('去結賬');
					return;
				}
				// 计算时间差（毫秒）
				var endTime = new Date(endTime).getTime(),
					startTime = new Date().getTime();
				if(endTime - startTime > 0){
					app.data.cartTime = endTime - startTime;
				}else{
					$$('#buyNow').html('去結賬');
					setCache('last_add_time', null, -1);
					window.clearInterval(app.data.timeout_interval);
					// location.reload();
				}

				var leftMinutes = app.methods.addNumber(Math.floor(app.data.cartTime / 1000 / 60 % 60));
				var leftSeconds = app.methods.addNumber(Math.floor(app.data.cartTime / 1000 % 60));
				
				$$('#buyNow span').eq(0).text(leftMinutes + ':' + leftSeconds);
			},
			addNumber: function(num) {
				var num = (num > 9) ? ('' + num) : ('0' + num);
				return num;
			},
		},
		cart: {
			// 加载上部标题
			initTopTip: function(){
				$$('.mdui-appbar-with-toolbar').css({'padding-top': '50px'})
				// if(app.datas._price.originalTotalPrice < app.datas.postageFreePrice){
				// 	// 不包邮 20
				// 	$$('.mdui-cart-promotion-container span').eq(0).html('再買$' + (app.datas.postageFreePrice - app.datas._price.originalTotalPrice) + '，免運費+立享8折價')
				// 	$$('.mdui-cart-promotion-container span').eq(1).html('去湊單<i class="mdui-icon material-icons array-right">keyboard_arrow_right</i>')
				// }else{
				// 	$$('.mdui-cart-promotion-container span').eq(0).html('已免運費 + 享8折價')
				// 	$$('.mdui-cart-promotion-container span').eq(1).html('再逛逛<i class="mdui-icon material-icons array-right">keyboard_arrow_right</i>')
				// }

				$$('.mdui-cart-promotion-container').show()
			},
			// 初始化數字選擇框
			initMduiNumbox : function(){
				$$('.mdui-numbox-btn-minus').on('click', function (e) {
                    var _that = this;
                   
                   
                    var value = parseInt($$(this).next().val()) - parseInt($$(this).parent().attr('data-numbox-step'));
                    if(value==0){
                        $$(this).parents('.mdui-float-right').children('.delete-icon')[0].click()
                        return
                    }
					if(value < parseInt($$(this).parent().attr('data-numbox-min'))){
						value = $$(this).parent().attr('data-numbox-min');
					}
					$$(this).next().val(value);					
					var _discountprice = $$(this).parents('li.mdui-list-item').attr('discountprice'),
						_productskuid = $$(this).parents('li.mdui-list-item').attr('productskuid');
					$$.each(app.datas.orderProducts, function(index , orderProduct) {
						if(orderProduct.productSkuId == _productskuid && orderProduct.discountPrice == _discountprice){
							orderProduct.quantity = $$(_that).next().val();
							return false;
						}
					});
					app.methods.initPayNum('change');
				});
				$$('.mdui-numbox-btn-plus').on('click', function (e) {
					var _that = this;
					var value = parseInt($$(this).prev().val()) + parseInt($$(this).parent().attr('data-numbox-step'));
					if(value > parseInt($$(this).parent().attr('data-numbox-max'))){
						value = $$(this).parent().attr('data-numbox-max');
					}
					$$(this).prev().val(value);
					var _discountprice = $$(this).parents('li.mdui-list-item').attr('discountprice'),
						_productskuid = $$(this).parents('li.mdui-list-item').attr('productskuid');
					$$.each(app.datas.orderProducts, function(index , orderProduct) {
						if(orderProduct.productSkuId == _productskuid && orderProduct.discountPrice == _discountprice){
							orderProduct.quantity = $$(_that).prev().val();
							return false;
						}
					});	
					app.methods.initPayNum('change');
				});
			},
			// 初始化刪除圖標刪除事件
			initProductDelete : function(){
				$$('.mdui-cart-products .mdui-list-item .delete-icon').on('click' , function(){
                    var _that = this , _liDOM = $$(_that).parents('li.mdui-list-item') , _deleteProduct = null;
					var _primaryskuid = $$(_that).parents('li.mdui-list-item').attr('primaryskuid'),
						_discountprice = $$(this).parents('li.mdui-list-item').attr('discountprice'),
						_discountTotalPrice = $$(this).parents('li.mdui-list-item').attr('discounttotalprice'),
						_productskuid = $$(this).parents('li.mdui-list-item').attr('productSkuId');
					$$.each(app.datas.orderProducts, function(index , orderProduct) {
						if(orderProduct.productSkuId == _productskuid && orderProduct.discountPrice == _discountprice){
							_deleteProduct = orderProduct ;
							return false;
						}else if(orderProduct.presents && (orderProduct.productSkuId == _primaryskuid)){
							$$.each(orderProduct.presents, function(index , orderProduct2) {
								if(orderProduct2.productSkuId == _productskuid){
									_deleteProduct = orderProduct2 ; 
									return false;
								}
							});
						}
					});
					if(!_deleteProduct)return false;
					mdui.dialog({
						cssClass : 'delete-confirm',
						title: '確定要刪除此商品?',
						content: '<img class="mdui-cart-product-sku-img" src="'+ _deleteProduct.productImageUrl +'">'
								+'<div class="mdui-cart-product-sku-info">'
								+'	<div class="mdui-list-item-title mdui-list-item-one-line">'+ _deleteProduct.productTitle +'</div>'
								+'	<div class="mdui-list-item-text mdui-list-item-one-line">'+ _deleteProduct.productSkuName +'</div>'
								+'</div>',
						buttons: [{
								text: '確認',
								onClick: function(inst){
									var _newProducts = [];
									/**
									 * 在這裏需要判斷,是刪除的主商品還是贈品,如果是主商品,則,其對應的贈品也刪除了,如果是贈品,需要明確出該贈品對應的主商品
									 */
									var _productDOM = $$(_that).parents('li.mdui-list-item') ; 
									
									if(_productDOM.hasClass('gift-item')){//說明是贈品
										$$.each(app.datas.orderProducts, function(index , orderProduct) {
											if(orderProduct.presents && (orderProduct.productSkuId == _primaryskuid)){
												var _presents = [];
												$$.each(orderProduct.presents, function(index2 , present) {
													if(present.productSkuId != _productskuid){
														_presents.push(present);
													}
												});
												orderProduct.presents = _presents ; 
											}
											_newProducts.push(orderProduct);
										});
									}else{//說明是主商品
										$$.each(app.datas.orderProducts, function(index , orderProduct) {
											if(orderProduct.productSkuId != _productskuid || orderProduct.discountPrice != _discountprice){
												_newProducts.push(orderProduct);
											}
										});
									}
									app.datas.orderProducts = _newProducts
									inst.close();
									app.methods.initPayNum();
								}
							},
							{
								text: '取消',
								onClick: function(inst){
									inst.close();
								}
							}
						]
					});
				});
			},
			// 處理[立即購買]按鈕事件
			initbuyNowAction : function(){
				var buyNow = $$('#buyNow');
				var _mainProduct = [];
				$$('.mdui-cart-products .mdui-list-item').map(function(i,e){
					if($(e).find('.check-icon').hasClass('active')){
						_mainProduct.push(e)
					}
				})
				if(_mainProduct.length == 0){
					buyNow.addClass('no-active');
				}else{
					buyNow.removeClass('no-active');
				}
			},
			// 初始化radio事件
			initProductListItemClick : function(){
	        	$$('.mdui-cart-products .mdui-list .mdui-list-item .check-icon:not(.exchange-check)').on('click', function (e) {
					var _cartProducts = app.datas.orderProducts, 
						_orderProducts = [];
					var productskuid = $$(e.target).parents('.mdui-list-item').attr('productskuid'),
						discountprice = $$(e.target).parents('.mdui-list-item').attr('discountprice');
	        		if($$(this).hasClass('active')){
						// 取消勾选
	        			$$(this).attr('src' , 'https://d3o2c7bn83e5x8.cloudfront.net/image/icon_no_check.png');
	        			
	        			if($$(this).parents('.mdui-cart-products').hasClass('mdui-cart-promotions')){
	        				// 營銷活動產品:
	        				$$(this).parents('.mdui-list-item').siblings().find('img.check-icon.exchange-check').attr('src' , 'https://d3o2c7bn83e5x8.cloudfront.net/image/icon_no_check_gift.png');
	        				$$(this).parents('.mdui-list-item').siblings().find('img.check-icon.exchange-check').removeClass('active');
	        			}
	        			
						$$(this).removeClass('active');
						
						_cartProducts.map(function(_e){
							var data = _e;
							if(productskuid == data.productSkuId && discountprice == data.discountPrice){
								data.isSelect = false;
							}
							_orderProducts.push(data)
						})
						app.datas.orderProducts = _orderProducts
	        		}else{
						// 勾选
	        			$$(this).attr('src' , 'https://d3o2c7bn83e5x8.cloudfront.net/image/icon_check.png');
	        			
	        			if($$(this).parents('.mdui-cart-products').hasClass('mdui-cart-promotions')){
	        				// 營銷活動產品:
	        				$$(this).parents('.mdui-list-item').siblings().find('img.check-icon.exchange-check').attr('src' , 'https://d3o2c7bn83e5x8.cloudfront.net/image/icon-exchange-check.png');
	        				$$(this).parents('.mdui-list-item').siblings().find('img.check-icon.exchange-check').addClass('active');
	        			}
	        			
						$$(this).addClass('active');
						
						_cartProducts.map(function(_e){
							var data = _e;
							if(productskuid == data.productSkuId && discountprice == data.discountPrice){
								data.isSelect = true;
							}
							_orderProducts.push(data)
						})
						app.datas.orderProducts = _orderProducts
					}
					// 触发统计购物车并后台计算价格
					app.methods.initPayNum();
				});
	        },
		},
		init : function(){
			app.methods.initbuyNowTime();
			tools.loading();
			app.methods.initPageStatus();
			tools.initScopeInfo();
			app.methods.initCartProducts();
			// app.methods.initDefaultEvents();
			app.methods.initShoppingCart();
			app.methods.getClick();
			app.methods.initSelectPayType();
			tools.hideLoading();
			app.methods.androidFbbrower()
		}
	}
	$$(function(){
		app.init();
	});
	// window.addEventListener('pageshow', function( e ){
	// 	if (e.persisted) {
	// 		window.location.reload();
	// 	}
	// });
</script>

